<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Menu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="stylesheets/reset.css">
    <link rel="stylesheet" href="stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_417789_zgddorp5rq.css">
    <link rel="stylesheet" href="stylesheets/1/1/1.css">
</head>

<body>
    <header>
          <div class="mobile-header-info">
             <div class="m-language-container" id="m-language-container">
                 <div class="language-bar">
                      <a class="pull-right" href="javascript:;" id="selectLangBtn"><i class="iconfont icon-back"></i></a>
                      <h2>选择语言版本</h2>
                 </div>
                
                 <ul>
                     <li>
                         <a href="javascript:;">中文</a>
                         <a href="javascript:;">英文</a>
                         <a href="javascript:;">英文</a>
                         <a href="javascript:;">日文</a>
                     </li>
                 </ul>
             </div>
             <a class="m-language" href="javascript:;" id="langSelect">
                 <span>中</span><i class="iconfont icon-arrow-down"></i>
             </a>

             <div class="profile">
                 <div class="avatar">
                     <img src="images/head.jpg" alt="">
                 </div>
                 <div class="detail">
                     <h2>alalla</h2>
                     <ul class="message">
                         <li><i class="iconfont icon-youxiang"></i><span>3</span></li>
                         <li><i class="iconfont icon-youxiang"></i><span>2</span></li>
                     </ul>
                 </div>
             </div>
          </div>
          <div class="menu-nav" id="menu-nav">
                <div class="menu-items-container">
                    <a id="menu-nav-prev" href="javascript:;"><</a>
                    <ul class="menu-items" id="menu-items">
                        <li class="menu-nav-item current dropdown">
                            <a href="javascript:;">技术亮点及业绩<i class="iconfont icon-arrowdropdown"></i></a>
                            <ul class="sub-menu second-sub-menu">
                                <li class="dropdown">
                                    <a href="javascript:;">技术亮<i class="iconfont icon-arrowdropdown"></i></a>
                                    <ul class="sub-menu">
                                        <li><a href="">技术亮点及业绩-2</a></li>
                                        <li><a href="">技术亮点及业绩-2</a></li>
                                        <li><a href="">技术亮点及业绩-22323233232</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="menu-nav-item dropdown">
                            <a href="javascript:;">Contact US中国股市地方发书法<i class="iconfont icon-arrowdropdown"></i></a>
                            <ul class="sub-menu second-sub-menu">
                                <li class="dropdown">
                                    <a href="javascript:;">FNDDDD<i class="iconfont icon-arrowdropdown"></i></a>
                                    <ul class="sub-menu">
                                        <li><a href="http://www.baidu.com">BD</a></li>
                                        <li><a href="">技术亮点及业绩-2</a></li>
                                        <li><a href="">技术亮点及业绩-22323233232</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="menu-nav-item"><a href="#">find-1万色时代ii技术亮点及业绩</a></li>
                        <li class="menu-nav-item"><a href="#">技术亮点及业</a></li>
                        <li class="menu-nav-item"><a href="#">find-3</a></li>
                        <li class="menu-nav-item"><a href="#">find-5</a></li>
                        <li class="menu-nav-item"><a href="#">find-6</a></li>
                        <li class="menu-nav-item"><a href="#">find-9</a></li>
                        <li class="menu-nav-item"><a href="#">find-10</a></li>
                        <li class="menu-nav-item"><a href="#">find-11</a></li>
                        <li class="menu-nav-item"><a href="#">find-12</a></li>
                        <li class="menu-nav-item"><a href="#">find-13</a></li>
                        <li class="menu-nav-item"><a href="#">find-14</a></li>
                        <li class="menu-nav-item"><a href="#">find-技术亮点及业绩</a></li>
                        <li class="menu-nav-item"><a href="#">find-技术亮点及业绩2</a></li>
                        <li class="menu-nav-item"><a href="#">Last</a></li>
                    </ul>
                    <a id="menu-nav-next" href="javascript:;">></a>
                </div>
                
          </div> 
    </header>
    <main class="content" id="content">
        <div class="mobile-header-bar">
            <a class="ham pull-left" href="javascript:;" id="ham">
                <span class="drawer-hamburger-icon"></span>
            </a>


            <a class="m-logo" href="#"><img src="images/art365logo.png" alt=""></a>
            <!-- <a class="m-logo" href="#"><img src="images/head.jpg" alt=""></a> -->
            <a class="m-search" href="javascript:;" id="m-search"><i class="iconfont icon-search"></i></a>
            <div>
                <form action="">
                    <input class="form-control m-search-input" type="text" placeholder="搜索" required id="m-search-input">
                </form>
            </div>
            
        </div>
        <div class="scroll-view">
            <section id="layout" style="height: 2000px;">
                hello layout
            </section>
        </div>
    </main>

    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script>
        var threshold = 768;

        $(function () {
            $('#ham').on('click', function() {
               $('body').toggleClass('open')
            })

            $('#m-search').on('click', function() {
                $('#m-search-input').addClass("show")
            })

            $('#layout').on('click', function() {
                if (isMobileMode()) {
                    $('body').hasClass('open') && $('#ham').trigger('click')
                    $('#m-search-input').removeClass("show")
                }
                
            })

            //----------------------------固定菜单栏--------------------------//
            var $nav = $('#menu-nav')
            var offset = $nav.offset().top

            var hasFixed = false

            $(window).on('scroll', function() {
                if ($(document).scrollTop() > offset && !hasFixed) {
                    $nav.addClass("fixed")
                    hasFixed = true
                } else if ($(document).scrollTop() <= offset && hasFixed) {
                    $nav.removeClass("fixed")
                    hasFixed = false
                }
            })

            function isMobileMode() {
                return document.documentElement.clientWidth <= threshold
            }


            //----------------------------翻页--------------------------//
            var $firstItem = $('#menu-items .menu-nav-item:first-child')
            var $menuNavPrev = $('#menu-nav-prev')
            var $menuNavNext = $('#menu-nav-next')

            var pageWidth = 0;

            var totalWidth = 0
            $('.menu-nav-item').each(function() {
                totalWidth += $(this).width()
            })
     
            var maxOffset = 0
            var minOffset = 0
            var offsetCursor = 0

            if (!isMobileMode()) { //初始化pc菜单
                initData()
                initItem() 
                $('body').addClass('pc')
            } else {
                $('body').addClass('mobile')

                //----------------------------mobile菜单栏--------------------------//
                $('header li.dropdown > a').on('click', function (e) {
                    $(this).parent().toggleClass('open')
                    $(this).next().slideToggle()
                })

            }

            // console.log('pageWidth:%f, totalWidth:%f', pageWidth, totalWidth)

            $(window).on('resize', function() {

                initData()
                initItem() 

                if (offsetCursor >= minOffset) {
                    offsetCursor = minOffset
                } else if (offsetCursor <= maxOffset) {
                    offsetCursor = maxOffset
                }

                console.log("offset: %f", offsetCursor)
                offsetItem(offsetCursor)
            })

            $menuNavNext.on('click', function() {
                    offsetCursor = offsetCursor - pageWidth

                    if (offsetCursor < maxOffset ) { //最后一页
                        offsetCursor = maxOffset
                    } 
                    offsetItem(offsetCursor)
               
            })

            $menuNavPrev.on('click', function() {
                    offsetCursor = offsetCursor + pageWidth

                    if (offsetCursor > minOffset ) { //第一页
                        offsetCursor = minOffset
                    } 

                    offsetItem(offsetCursor)
            })

            function offsetItem(offsetCursor) {
                $firstItem.css('margin-left', offsetCursor)
                initItem()
            }

            function initData() {
                 pageWidth = $('#menu-items').width() //一页的宽度
                 maxOffset = pageWidth - totalWidth
            }

            function initItem() {
                if (offsetCursor > maxOffset) { //是否有下一页
                    $menuNavNext.addClass('show')
                } else {
                    $menuNavNext.removeClass('show')
                }

                if (offsetCursor < minOffset) { //是否有上一页
                    $menuNavPrev.addClass('show')
                } else {
                     $menuNavPrev.removeClass('show')
                }
            }

        })

        

        //----------------------------mobile语言切换--------------------------//
        $('#selectLangBtn, #langSelect').on('click', function () {
            $('#m-language-container').toggleClass('open')
        })
    </script>
</body>
</html>